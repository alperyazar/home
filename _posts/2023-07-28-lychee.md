---
title: "lychee: KÄ±rÄ±k Link KalmasÄ±n"
excerpt: "CI entegrasyonu yapabileceÄŸiniz, Markdown ve HTML'de link kontrolÃ¼ yapan bir araÃ§"
published: true
tags:
  - tr
axseq: 6
image: /assets/img/23/6.png
---

Bu yazÄ±mda kÄ±saca ÅŸu an gÃ¶rmekte olduÄŸunuz kiÅŸisel web sitemde de kullandÄ±ÄŸÄ±m
bir araÃ§tan bahsetmek istiyorum:
[lychee](https://github.com/lycheeverse/lychee). (AyrÄ±ca bakÄ±nÄ±z:
[LiÃ§i](https://tr.wikipedia.org/wiki/Li%C3%A7i) meyvesi)

lychee, Rust dilinde yazÄ±lmÄ±ÅŸ bir araÃ§. Temel iÅŸlevi Markdown, HTML gibi dosyalarÄ±
tarayarak, olasÄ± "kÄ±rÄ±lmÄ±ÅŸ" ya da "Ã¶lmÃ¼ÅŸ" linkleri yani baÄŸlantÄ±larÄ± bulmak.

> âš ï¸ [Lychee](https://github.com/LycheeOrg/Lychee) isminde bir de bir fotoÄŸraf
> yÃ¶netim yazÄ±lÄ±mÄ± bulunuyor, bunun ile karÄ±ÅŸtÄ±rmayÄ±n. Åu an incelediÄŸimiz
> aracÄ±n adÄ±nÄ±n tÃ¼m harfleri kÃ¼Ã§Ã¼k.

## Neden kullanÄ±yorum?

Seyrek de olsa 2011 yÄ±lÄ±ndan beri yazdÄ±ÄŸÄ±m yazÄ±lar var. Bu yazÄ±larÄ±n iÃ§erisinde
baÅŸka sitelere baÄŸlantÄ±lar oluyor. Bir okuyucu olarak gezindiÄŸim sitelerdeki
linklerin olmayan sayfalara gitmesi benim iÃ§in hoÅŸ bir deneyim olmuyor. Kendi
yazÄ±larÄ±mdaki kÄ±rÄ±k linkleri de otomatik bir ÅŸekilde bulabilmek adÄ±na Github
Actions ile bu aracÄ± kullanÄ±yorum.

lychee'yi bilgisayarÄ±nÄ±za Ã§eÅŸitli yollarla kurabilirsiniz, sitesinde
[anlatÄ±lÄ±yor.](https://github.com/lycheeverse/lychee#installation) En pratik
kullanÄ±m ise bence Docker kullanmak, hele bir de Windows Ã¼zerinde Ã§alÄ±ÅŸÄ±yorsanÄ±z.
Komut satÄ±rÄ±ndan Ã§alÄ±ÅŸan bu araÃ§, bir komut satÄ±rÄ± uygulamasÄ±na gÃ¶re renkli ve
hoÅŸ gÃ¶rÃ¼nÃ¼ÅŸlÃ¼ Ã§Ä±ktÄ±lar da Ã¼retiyor.

![TatlÄ± lychee](/assets/img/23/6-a.png){:.centered}

{:.text-align-center}
*Åunun tatlÄ±lÄ±ÄŸÄ±na bir bak abisi!*

[Kendi sayfasÄ±ndaki](https://github.com/lycheeverse/lychee) dokÃ¼mantasyonu oldukÃ§a
iyi, o yÃ¼zden ben biraz kendi kullanÄ±mÄ±mdan bahsedeceÄŸim.

YazÄ±lÄ±mÄ± Ã§aÄŸÄ±rÄ±rken komut satÄ±rÄ± argÃ¼manlarÄ± ile veya bir TOML formatÄ±ndaki
konfigÃ¼rasyon dosyasÄ± ile (oldukÃ§a fazla) Ã§eÅŸitli ayarlar geÃ§irmek mÃ¼mkÃ¼n.
VarsayÄ±lan olarak `lychee.toml` isimli bir dosyayÄ± okuyor. Bu web sitesinde
kullandÄ±ÄŸÄ±m TOML dosyasÄ±na
[buradan](https://github.com/alperyazar/home/blob/master/lychee.toml)
eriÅŸebilirsiniz.

Ben Markdown dosyalarÄ± Ã¼zerinde bu aracÄ± Ã§alÄ±ÅŸtÄ±rÄ±yorum. Benim gibi statik bir
web sitesi Ã¼reteci kullanÄ±yorsanÄ±z (bu site [Jekyll](https://jekyllrb.com/) ile
Ã¼retiliyor, en azÄ±ndan bu yazÄ±nÄ±n yazÄ±ldÄ±ÄŸÄ± zaman) oluÅŸturulan HTML dosyalarÄ±
Ã¼zerinde de lychee'yi Ã§alÄ±ÅŸtÄ±rabilirsiniz. Bu sayede hem Markdown'dan verdiÄŸiniz
linkleri hem de Ã¼retecin Ã¼rettiÄŸi ve aÄŸÄ±rlÄ±klÄ± site iÃ§i navigasyon linklerini de
test edebiliriz. Kendi durumumda Markdown dosyalarÄ±nda kontrol ettirmeyi yeterli
gÃ¶rdÃ¼m. Markdown iÃ§erisinde verilmiÅŸ gÃ¶receli (relative) baÄŸlantÄ± ve gÃ¶rsel
gÃ¶sterme kÄ±sÄ±mlarÄ±nÄ± da kontrol ettiÄŸini gÃ¶zlemledim.

KonfigÃ¼rasyon dosyasÄ±nda veya komut satÄ±rÄ± argÃ¼manlarÄ±nda Ã§eÅŸitli seÃ§enekler
geÃ§irirken [glob](https://en.wikipedia.org/wiki/Glob_(programming)) kullanabiliyoruz,
`**` gibi karakterler, ama alÄ±ÅŸkÄ±n olduÄŸumuz Bash stilinden sanÄ±yorum biraz farklÄ±
davranÄ±yor. Bu yÃ¼zden aracÄ±n dokÃ¼mantasyonuna bakmakta fayda var.

lychee, elbette bu iÅŸi yapan tek araÃ§ deÄŸil. Kendi sitesinde de diÄŸer araÃ§larla
yapÄ±lmÄ±ÅŸ detaylÄ± bir karÅŸÄ±laÅŸtÄ±rma tablosu
[var.](https://github.com/lycheeverse/lychee#features) Mesela zamanÄ±nda Jekyll
ile beraber kullandÄ±ÄŸÄ±m
[html-proofer](https://github.com/gjtorikian/html-proofer) diye bir araÃ§ daha
var. Bu araÃ§ Ruby temelli ve HTML Ã¼zerinde Ã§alÄ±ÅŸÄ±yordu. HatÄ±rladÄ±ÄŸÄ±m kadarÄ±yla
lychee'den daha yavaÅŸtÄ±. BÃ¶yle birÃ§ok araÃ§ bulabilirsiniz.

## Docker

lychee Docker ile Ã§ok pratik bir ÅŸekilde Ã§alÄ±ÅŸtÄ±rÄ±labilir. Kendi sitem iÃ§in:

```shell
docker run --init --rm -it -v ${PWD}:/input lycheeverse/lychee -c /input/lychee.toml --exclude-path /input/vendor "/input/**/*.md"
```

ifadesi yeterli oluyor Ã¶rneÄŸin. Bu kullanÄ±mda Windows Ã¼zerinde de rahatlÄ±kla
Ã§alÄ±ÅŸtÄ±rÄ±labiliyor.

## CI

lychee kolaylÄ±kla CI pipeline'larÄ±na entegre olabiliyor. Ä°lk olarak Gitlab ile
baÅŸlayalÄ±m

### Gitlab CI

```yml
lychee:
  image:
    name: lycheeverse/lychee
    entrypoint: [""]
  needs: []
  before_script:
    - lychee --version
  script:
    - lychee -c lychee.toml "./docs/**/*.md"
```

Gitlab CI ile tipik olarak bu ÅŸekilde kullanÄ±labilir. Dikkat ederseniz burada
`ENTRYPOINT` i override ediyorum ve sanki terminal Ã¼zerinden kullanÄ±yorum gibi
bir script hazÄ±rlÄ±yorum. Bu bana daha kolay geldi, varsayÄ±lan olarak `ENTRYPOINT
["/usr/local/bin/lychee"]`
[tanÄ±mlanmÄ±ÅŸ](https://hub.docker.com/layers/lycheeverse/lychee/latest/images/sha256-0ee1779a9102c57d6bd4e3133e557d26d4fe6ca9fe9c05382d5eb2cd8a091cf8?context=explore)
durumda.

## Github Actions

Bu web sitesinde Github Actions ile kullanÄ±yorum. Ä°lgili workflow'larÄ±n Ã§Ä±ktÄ±larÄ±na
[buradan](https://github.com/alperyazar/home/actions/workflows/md-link-check.yml)
bakabilirsiniz.

KullandÄ±ÄŸÄ±m konfigÃ¼rasyon da ÅŸu ÅŸekilde (ÅŸimdilik):

```yml
# Ref: https://github.com/lycheeverse/lychee-action
# Ref: https://github.com/selfhostedshow/wiki/blob/master/.github/workflows/brokenLinks.yml
name: Check markdown links

on:
  schedule:
    # UTC Time, At 15:00 on day-of-month 1.
    - cron: "0 15 1 * *"
  workflow_dispatch:
  repository_dispatch:

jobs:
  linkChecker:
    permissions:
      issues: write
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Link Checker
        uses: lycheeverse/lychee-action@v1.8.0
        with:
          args: --verbose './**/*.md'

      - name: Create Issue From File
        if: env.lychee_exit_code != 0
        uses: peter-evans/create-issue-from-file@v4
        with:
          title: Link Checker Report
          content-filepath: ./lychee/out.md
          labels: report, automated issue, broken-link
          assignees: alperyazar
```

GÃ¼ncelini [buradan](https://github.com/alperyazar/home/blob/master/.github/workflows/md-link-check.yml)
kontrol etmekte fayda var. Burada [lychee-action](https://github.com/lycheeverse/lychee-action)
ile beraber [create-issue-from-file](https://github.com/peter-evans/create-issue-from-file)
Ä± da kullanÄ±yorum. BÃ¶ylece lychee kÄ±rÄ±k linkler bulduÄŸu zaman bana bir issue da
aÃ§mÄ±ÅŸ oluyor. Uygun bir zamanda ben de bunlarÄ± dÃ¼zeltiyorum.

TÃ¼m linklerin her merge Ã¶ncesi kontrol edilmesi hem gereksiz hem de uzun sÃ¼ren
bir iÅŸ olduÄŸu iÃ§in (alternatif olarak o merge ile eklenen yeni linklerin
kontrol edilmesi yapÄ±labilir ama o da ayrÄ± bir iÅŸ) ben periyodik bir kontrol
yapÄ±yorum. GÃ¼ncel durumda ayda 1 link kontrolÃ¼ Github Actions tarafÄ±ndan yapÄ±lÄ±yor
ve bir sorun olursa bana issue aÃ§Ä±lÄ±yor. Kendi sitem iÃ§in bu sÄ±klÄ±k ve otomasyon
yeterli.

![Ã–rnek bir issue](/assets/img/23/6-1.png){:.centered}

{:.text-align-center}
*Bu websitesinin reposunda otomatik olarak aÃ§Ä±lmÄ±ÅŸ bir issue:*
[Link](https://github.com/alperyazar/home/issues/4)

## Son SÃ¶zler

Rust dilinde olduÄŸundan mÄ±dÄ±r nedir bilmem ğŸ˜ lychee oldukÃ§a hÄ±zlÄ± Ã§alÄ±ÅŸÄ±yor
ve birÃ§ok deÄŸiÅŸtirilebilir ayara da sahip. Docker imajÄ± sayesinde de lokalde
ya da CI'da kolaylÄ±kla kullanÄ±labiliyor. Ek olarak doÄŸrudan Github Actions'ta
da yer almasÄ± iÅŸimizi kolaylaÅŸtÄ±rÄ±yor. Komut satÄ±rÄ±na da renkli ve tatlÄ± Ã§Ä±ktÄ±lar
Ã¼retiyor. Åimdilik severek kullanÄ±yorum.

lychee belirttiÄŸim gibi Markdown dosyalarÄ± iÃ§erisinde verilmiÅŸ gÃ¶receli (relative)
sayfa (diÄŸer Markdown dosyalarÄ±na) baÄŸlantÄ±larÄ±nÄ± ve gÃ¶rselleri
(`![]()` formundakiler) kontrol ediyor. Bu kÄ±sÄ±m, Markdown dosyalarÄ±nÄ± "sade"
bir ÅŸekilde kullanÄ±yorsanÄ±z yani bir baÅŸka araÃ§ ile HTML Ã§Ä±ktÄ±lar Ã¼retmiyorsanÄ±z
da faydalÄ± olabilir, mesela Markdown dosyalarÄ±nÄ± doÄŸrudan Github, Gitlab ya da
VS Code ile gÃ¶rÃ¼ntÃ¼lÃ¼yorsanÄ±z. Bu gibi durumlardaki iÃ§ baÄŸlantÄ± hatalarÄ±nÄ± da
bulmanÄ±za yardÄ±mcÄ± olacaktÄ±r. Ama Markdown dosyalarÄ±nÄ±zÄ±, bir derleme iÅŸlemine
sokuyorsanÄ±z kullandÄ±ÄŸÄ±nÄ±z araÃ§ bu tarz iÃ§ baÄŸlantÄ±lardaki hatalarÄ± yakalayabilir,
Ã¶rneÄŸin [Sphinx](https://www.sphinx-doc.org) bunu yapabiliyor.

**Sizce nasÄ±l?** GÃ¶rÃ¼ÅŸlerinizi yorum yaparak iletebilirsinizâ€¦
